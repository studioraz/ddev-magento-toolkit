# Details about the install.yaml file are at https://ddev.readthedocs.io/en/stable/users/extend/additional-services/#sections-and-features-of-ddev-get-add-on-installyaml

name: ddev-magento-toolkit

# list of files and directories listed that are copied into project .ddev directory
# Each file should contain #ddev-generated so it can be replaced by a later `ddev add-on get`
# if it hasn't been modified by the user.
# DDEV environment variables can be interpolated into these filenames
# If you use directories, they must be directories that are managed
# by this add-on, or removal could remove things that are not owned by it
project_files:
  - commands/web/dep
  - commands/web/n98
  - commands/web/generate-env
  - config.magento.hooks.yaml
  - scripts/magento-toolkit/n98-magerun/install.sh
  - scripts/magento-toolkit/n98-magerun/uninstall.sh

# List of add-on names that this add-on depends on
dependencies:
  - ddev/ddev-redis
  - ddev/ddev-opensearch

# DDEV environment variables can be interpolated into these actions.
# post_install_actions are executed in the context of the target project's .ddev directory.
post_install_actions:
  - |
    #ddev-generated: ensure all scripts are executable
    find scripts/magento-toolkit -type f -name "*.sh" -exec chmod +x {} \;
    #ddev-generated: download n98-magerun2.phar
    scripts/n98-magerun/install.sh

# Shell actions that can be done during removal of the add-on.
# Files listed in project_files section will be automatically removed here if they contain #ddev-generated line.
# removal_actions are executed in the context of the target project's .ddev directory.
removal_actions:
  - |
    #ddev-generated: remove n98-magerun2.phar
    scripts/magento-toolkit/n98-magerun/uninstall.sh
  
